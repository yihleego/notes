# 索引结构

只针对 InnoDB 存储引擎进行分析。

## B+Tree

为什么 InnoDB 存储引擎选择`B+Tree`而不是`Hash`或者`B-Tree`的原因：

- `Hash`虽然能够提供`O(1)`的单数据行操作性能，但是对于范围查询和排序却无法很好地支持，最终导致全表扫描。
- `B-Tree`能够在非叶节点中存储数据，但是这也导致在查询连续数据时可能会带来更多的随机 I/O，而`B+Tree`的所有叶节点可以通过指针相互连接，能够减少顺序遍历时产生的额外随机 I/O。

## 聚簇索引和非聚簇索引

B-Tree是左小右大的顺序存储结构，节点只包含主键索引列，而叶子节点包含索引列和数据，这种数据和索引在一起存储的索引方式叫做聚簇索引，一张表只能有一个聚簇索引。

假设没有定义主键，InnoDB会选择一个唯一的非空索引代替，如果没有的话则会隐式定义一个主键作为聚簇索引。

非聚簇索引只包含索引对应字段的值和主键的值。

## 覆盖索引和回表

覆盖索引指的是在一次查询中，如果一个索引包含或者说覆盖所有需要查询的字段的值，我们就称之为覆盖索引，而不再需要回表查询。

而要确定一个查询是否是覆盖索引，我们只需要`EXPLAIN`语句看`Extra`的结果是否是`Using index`即可。
